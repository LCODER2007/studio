{
  "entities": {
    "Suggestion": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Suggestion",
      "type": "object",
      "description": "Represents a suggestion submitted by a user.",
      "properties": {
        "suggestionId": {
          "type": "string",
          "description": "Unique identifier for the suggestion entity.",
          "format": "uuid"
        },
        "title": {
          "type": "string",
          "description": "Title of the suggestion.",
          "format": "string"
        },
        "body": {
          "type": "string",
          "description": "Detailed description of the suggestion."
        },
        "authorUid": {
          "type": "string",
          "description": "Reference to User. Unique identifier of the user who created the suggestion. Can be 'ANONYMOUS'."
        },
        "category": {
          "type": "string",
          "description": "Category of the suggestion (ACADEMIC_CURRICULUM, INFRASTRUCTURE_IT, TECHNICAL_DESIGN, ENVIRONMENTAL_SUSTAINABILITY, ADMINISTRATIVE_SEES, OTHER)."
        },
        "status": {
          "type": "string",
          "description": "Status of the suggestion (SUBMITTED, UNDER_REVIEW, SHORTLISTED, ARCHIVED_REJECTED, IMPLEMENTED)."
        },
        "upvotesCount": {
          "type": "number",
          "description": "Number of upvotes the suggestion has received."
        },
        "impactScore": {
          "type": "number",
          "description": "Impact score of the suggestion (1-5, admin rated)."
        },
        "feasibilityRating": {
          "type": "number",
          "description": "Feasibility rating of the suggestion (1-5, admin rated)."
        },
        "costEffectivenessRating": {
          "type": "number",
          "description": "Cost-effectiveness rating of the suggestion (1-5, admin rated)."
        },
        "reviewerUid": {
          "type": "string",
          "description": "Reference to User. Unique identifier of the admin/reviewer user who reviewed the suggestion."
        },
        "submissionTimestamp": {
          "type": "string",
          "description": "Timestamp of when the suggestion was submitted.",
          "format": "date-time"
        },
        "publicFeedback": {
          "type": "string",
          "description": "Public feedback or comments on the suggestion."
        }
      },
      "required": [
        "suggestionId",
        "title",
        "body",
        "authorUid",
        "category",
        "status",
        "upvotesCount",
        "submissionTimestamp"
      ]
    },
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user profile.",
      "properties": {
        "uid": {
          "type": "string",
          "description": "Unique identifier for the user entity."
        },
        "email": {
          "type": "string",
          "description": "User's email address.",
          "format": "email"
        },
        "displayName": {
          "type": "string",
          "description": "User's display name."
        },
        "role": {
          "type": "string",
          "description": "User's role (STUDENT, ADMIN, SUPER_ADMIN)."
        }
      },
      "required": [
        "uid",
        "email",
        "displayName",
        "role"
      ]
    },
    "Vote": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Vote",
      "type": "object",
      "description": "Represents a user's vote on a suggestion.",
      "properties": {
        "suggestionId": {
          "type": "string",
          "description": "Reference to Suggestion. Unique identifier of the suggestion being voted on."
        },
        "voterUid": {
          "type": "string",
          "description": "Reference to User. Unique identifier of the user casting the vote."
        },
        "timestamp": {
          "type": "string",
          "description": "Timestamp of when the vote was cast.",
          "format": "date-time"
        }
      },
      "required": [
        "suggestionId",
        "voterUid",
        "timestamp"
      ]
    },
    "Comment": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Comment",
      "type": "object",
      "description": "Represents a comment on a suggestion.",
      "properties": {
        "commentId": {
          "type": "string",
          "description": "Unique identifier for the comment entity."
        },
        "suggestionId": {
          "type": "string",
          "description": "Reference to Suggestion. Unique identifier of the suggestion being commented on."
        },
        "authorUid": {
          "type": "string",
          "description": "Reference to User. Unique identifier of the user who wrote the comment."
        },
        "body": {
          "type": "string",
          "description": "Content of the comment."
        },
        "timestamp": {
          "type": "string",
          "description": "Timestamp of when the comment was posted.",
          "format": "date-time"
        }
      },
      "required": [
        "commentId",
        "suggestionId",
        "authorUid",
        "body",
        "timestamp"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{uid}",
        "definition": {
          "entityName": "User",
          "schema": {
            "$ref": "#/backend/entities/User"
          },
          "description": "Stores user profiles. The 'uid' is the document ID.",
          "params": [
            {
              "name": "uid",
              "description": "The unique identifier of the user."
            }
          ]
        }
      },
      {
        "path": "/suggestions/{suggestionId}",
        "definition": {
          "entityName": "Suggestion",
          "schema": {
            "$ref": "#/backend/entities/Suggestion"
          },
          "description": "Contains suggestion documents. The 'authorUid' field indicates the creator.",
          "params": [
            {
              "name": "suggestionId",
              "description": "The unique identifier of the suggestion."
            }
          ]
        }
      },
      {
        "path": "/votes/{voteId}",
        "definition": {
          "entityName": "Vote",
          "schema": {
            "$ref": "#/backend/entities/Vote"
          },
          "description": "Stores user votes on suggestions.  Includes 'suggestionId' and 'voterUid'.",
          "params": [
            {
              "name": "voteId",
              "description": "The unique identifier of the vote, can be a combination of userId and suggestionId."
            }
          ]
        }
      },
      {
        "path": "/comments/{commentId}",
        "definition": {
          "entityName": "Comment",
          "schema": {
            "$ref": "#/backend/entities/Comment"
          },
          "description": "Stores comments on suggestions. Includes 'suggestionId' to link comments to their respective suggestions, and 'authorUid' for comment authorship.",
          "params": [
            {
              "name": "commentId",
              "description": "The unique identifier of the comment."
            }
          ]
        }
      },
      {
        "path": "/roles_admin/{uid}",
        "definition": {
          "entityName": "roles_admin",
          "schema": {
            "$ref": "#/backend/entities/User"
          },
          "description": "Documents in this collection indicate admin privileges for a user. The existence of a document with a user's 'uid' as the document ID grants admin rights.",
          "params": [
            {
              "name": "uid",
              "description": "The unique identifier of the admin user."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore data structure is designed to support the SEES UNILAG Innovation Suggestion System (SIS) application, focusing on security, scalability, and maintainability. The structure adheres to the principle of Authorization Independence by denormalizing authorization context where necessary, especially concerning collaborative data. Structural Segregation is used to ensure that collections contain documents with homogeneous security postures, simplifying security rules. Access Modeling employs path-based ownership for user-related data and the Membership Map pattern for collaborative data.\n\nSpecifically:\n\n*   **/users/{uid}**: Stores user profiles. User roles are managed here, but for increased security and efficiency in rules, a separate collection for admin roles is also utilized.  The user's `uid` is the document ID, enabling direct access to user data.\n*   **/suggestions/{suggestionId}**: Contains suggestion documents. The `authorUid` field indicates the creator. All suggestions are readable, but updates to certain fields are restricted to admins.\n*   **/votes/{voteId}**: Stores user votes on suggestions. The vote ID can be a combination of `userId` and `suggestionId` to ensure uniqueness. Includes `suggestionId` and `voterUid`.\n*   **/comments/{commentId}**: Stores comments on suggestions. Includes `suggestionId` to link comments to their respective suggestions, and `authorUid` for comment authorship.\n*   **/roles_admin/{uid}**: Documents in this collection indicate admin privileges for a user. The existence of a document with a user's `uid` as the document ID grants admin rights. This approach simplifies security rules by allowing a simple `exists()` check.\n\nThis design enables secure `list` operations and avoids complex queries or client-side filtering. Security rules are straightforward due to denormalization and structural segregation, allowing for atomic operations and improved debuggability."
  }
}